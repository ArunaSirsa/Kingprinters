<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="Responsive Admin &amp; Dashboard Template based on Bootstrap 5">
	<meta name="author" content="AdminKit">
	<meta name="keywords" content="adminkit, bootstrap, bootstrap 5, admin, dashboard, template, responsive, css, sass, html, theme, front-end, ui kit, web">

	<link rel="preconnect" href="https://fonts.gstatic.com">
	<link rel="shortcut icon" href="img/icons/icon-48x48.png" />

	<link rel="canonical" href="https://demo-basic.adminkit.io/ui-forms.html" />

	<title>Forms | AdminKit Demo</title>

	<!-- <link href="css/app.css" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet"> -->

<!-- Feather Icons -->
<script src="https://unpkg.com/feather-icons"></script>

<link rel="stylesheet" href="css/custom.css">








</head>

<body>




<!-- SIDEBAR -->
<div id="sidebar">

</div>


<!-- HEADER -->
<div class="header"></div>





<main>

  <h1>Add Sub Category</h1>

  <div class="form-card">
    <form id ="addCategory" onsubmit="addSubCategory(event)">
<div class="row">

  <div class="form-group">
      <label>Item</label>
      <select id="itemDropdown" class="form-select mb-3" onchange="loadCategories()">
          <option value="">Select Item</option>
      </select>
  </div>

  <div class="form-group">
      <label>Category</label>
      <select id="categoryDropdown" class="form-select mb-3">
          <option value="">Select Category</option>
      </select>
  </div>

</div>


<div class="row">

  <div class="form-group">
      <label>Sub Category</label>
      <input type="text" id="name" placeholder="Enter Sub Category">
  </div>

  

</div>




         

      <button type="submit"  onclick="addSubCategory()">Save</button>

    </form>
  </div>




<!-- ⭐ NEW TABLE ADDED BELOW FORM ⭐ -->
<h1 style="margin-top:40px;">Sub Category List</h1>

<div class="table-card">
  <table>
    <thead>
      <tr>
       <th>ID</th>
      <th>Item Name</th>

      <th>Category</th>
      <th>SubCategory</th>
        <th style="width:100px;">Action</th>
      </tr>
    </thead>

    <tbody  id="subcategoryTableBody">
      <tr>
       
        <td class="action-buttons">
          <!-- <span class="edit-btn"><i data-feather="edit"></i></span>
          <span class="delete-btn"><i data-feather="trash-2"></i></span> -->
        </td>
      </tr>

      <tr>
       
       

    </tbody>
  </table>
</div>

  

</main>











<script>

// ACCORDION SUBMENU — only one open at a time
function toggleMenu(id){
    const allMenus = document.querySelectorAll(".submenu");

    allMenus.forEach(menu => {
        if(menu.id !== id){
            menu.style.display = "none";
        }
    });

    const current = document.getElementById(id);
    current.style.display = current.style.display === "block" ? "none" : "block";
}

// Load icons
feather.replace();

</script>


<script>
    // Load all subcategories and show in table


async function loadItems() {
    try {
        const response = await fetch("https://localhost:7171/api/Item");
        const items = await response.json();

        const dropdown = document.getElementById("itemDropdown");
        dropdown.innerHTML = "<option value=''>Select Item</option>";

        items.forEach(item => {
            const opt = document.createElement("option");
            opt.value = item.id;
            opt.textContent = item.name;
            dropdown.appendChild(opt);
        });
    } catch (error) {
        console.error("Error loading items:", error);
    }

}




// Page load pe call karo
document.addEventListener("DOMContentLoaded", loadItems);



</script>
<script>
async function loadCategories() {
    const itemId = document.getElementById("itemDropdown").value;
    if (!itemId) return;

    try {
        const response = await fetch(`https://localhost:7171/api/Category/GetByItem/${itemId}`);
        const categories = await response.json();

        const dropdown = document.getElementById("categoryDropdown");
        dropdown.innerHTML = "<option value=''>Select Category</option>";

        categories.forEach(cat => {
            const opt = document.createElement("option");
            opt.value = cat.id;
            opt.textContent = cat.name;
            dropdown.appendChild(opt);
        });
    } catch (error) {
        console.error("Error fetching categories:", error);
    }
}



</script>

<script>
async function addSubCategory() {
        event.preventDefault();

    const categoryId = document.getElementById("categoryDropdown").value;
    const name = document.getElementById("name").value.trim();
    
const body ={
name:name,
categoryId:parseInt(categoryId)


}

//console.log("body",body);


    if (!categoryId || !name) {
        alert("Please select a category and enter subcategory name.");
        return;
    }

    const response = await fetch("https://localhost:7171/api/SubCategory/Create", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            name: name,
            categoryId: parseInt(categoryId),
            status: "A"
        })
    });

    if (response.ok) {
        alert("SubCategory added successfully!");
        document.getElementById("subCategoryName").value = "";
    } else {
        alert("Failed to add SubCategory.");
    }
}
</script>

<script>
async function loadSubCategories() {
    try {
        const response = await fetch("https://localhost:7171/api/SubCategory/GetAllWithDetails");
        if (!response.ok) throw new Error("Network error");

        const data = await response.json();
        console.log("Loaded Data:", data);

        const tableBody = document.getElementById("subcategoryTableBody");
        tableBody.innerHTML = "";

        data.forEach(item => {
            const row = `
                <tr><td>${item.subCategoryId}</td>
                    <td>${item.itemName}</td>
                    <td>${item.categoryName}</td>
                    <td>${item.subCategoryName}</td>
                </tr>
            `;
            tableBody.innerHTML += row;
        });

    } catch (error) {
        console.error("Error fetching subcategories:", error);
    }
}

window.onload = loadSubCategories;
</script>

	<script src="js/app.js"></script>
<script src="../static/common.js"></script>



<script>
  fetch("shared/commonheader.html")
    .then(res => res.text())
    .then(data => {
        document.getElementById("header").innerHTML = data;
    });
</script>

<script>

// ACCORDION SUBMENU — only one open at a time
function toggleMenu(id){
    const allMenus = document.querySelectorAll(".submenu");

    allMenus.forEach(menu => {
        if(menu.id !== id){
            menu.style.display = "none";
        }
    });

    const current = document.getElementById(id);
    current.style.display = current.style.display === "block" ? "none" : "block";
}

// Load icons
feather.replace();

</script>

<script>
fetch("shared/sidebar.html")
    .then(res => res.text())
    .then(data => {
        document.getElementById("sidebar").innerHTML = data;
    });
</script>

</body>
</html>




